<html>

<head>
<title>Crystal Lattice</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">

<script type="text/javascript" src="src/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="src/webgl-utils.js"></script>
<script type="text/javascript" src="src/glMatrix.js"></script>


<script id="shader-vs" type="x-shader/x-vertex">
 
  attribute vec4 vertPos;
  attribute vec3 vertNor;
  uniform mat4 P;
  uniform mat4 MV;
  varying vec3 fragPos;
  varying vec3 fragNor;
  
  void main()
  {
     vec4 posCam = MV * vertPos;
     gl_Position = P * posCam;
     fragPos = posCam.xyz;
	 fragNor = (MV * vec4(vertNor, 0.0)).xyz;
  }

</script>

<script id="shader-fs" type="x-shader/x-fragment">
  
  varying vec3 fragPos; // in camera space
  varying vec3 fragNor; // in camera space
  uniform vec3 kdFront;
  uniform vec3 kdBack;
  uniform float alpha;

  void main()
  {   
	 vec3 lightPos = vec3(0.0, 0.0, 0.0);
	 vec3 n = normalize(fragNor);
	 vec3 l = normalize(lightPos - fragPos);
	 vec3 v = -normalize(fragPos);
	 vec3 h = normalize(l + v);
	 vec3 kd = kdFront;
	 float ln = dot(l, n);
	 if(ln < 0.0) {
		ln = -ln;
	 }
	 
     vec3 diffuse = ln * kd;
	 vec3 color = diffuse;
	 gl_FragColor = vec4(color, alpha);
  }

</script>

<script type="text/javascript">
  
  var gl;
  var prog;
  var camera;

  function initGL {
        // Setup canvas and Intialize Gl
        var canvas = document.getElementById("canvas");
        try {
            // Get context and configure viewports width & height
            gl = canvas.getContext("experimental-webgl");
            gl.viewportWidth = canvas.width;
            gl.viewportHeight = canvas.height;
        } catch (e) {
            alert("Error with getContext");
        }
        if (!gl) {
            alert("Could not initialize WebGL");
        }

        // Enable depth testing
        gl.enable(gl.DEPTH_TEST);
  }

  function webGLStart() {

        initGL();

        // Setup shader  
        prog = new Program("shader-vs", "shader-fs");
        prog.load();
        gl.useProgram(prog.getID());
        prog.addHandle()
        prog.addHandle();
        // ... add more handles

  
        // Scene.setup() // load objs ... etc
 
  
        // Setup scene with objects, camera, lights

        // Setup key events
        // User.setup();
  
        tick();
  }  

  
  
  function tick() {
        requestAnimFrame(tick);
        Scene.render();
  }    
                        
</script>

</head>

<body onload="webGLStart();">
  <center>
    <canvas id="canvas" style="border: none;" width="1200" height="900" align="center"></canvas>
  </center>
</body>

</html>
